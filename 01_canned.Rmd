
# (PART) Concepts {-}

# Power Analysis

## Canned routines

In some research designs, it can be an important step to calculate *a priori* statistical power. We use statistical power to determine the probability we can detect an effect of a given size, if such an effect does in fact exist. Researchers typically want to know the sample size required to reject a null hypothesis at a given power level, or alternatively, calculate power when sample size is fixed.

In some situations, such as a randomized controlled trial with two groups, we can use a formula to calculate the sample size required to reject a null hypothesis. We will use an example to show how we do this. For instance, when we plan to perform a test of an hypothesis comparing the proportions of successes of tossing coins of faces in two independent populations, we would specify the following null and alternative hypotheses, respectively: 
$$
H_{0} :p_{1} = p_{2}
$$ 

$$
H_{1} :p_{1} \neq p_{2}
$$

where $p\_{1} = p\_{2}$ are the proportions in the two populations for comparison. To make sure the test has a specific power, we can use the following formula to determine the sample sizes: 
$$
N = 2(\frac{z_{1-\frac{\alpha}{2}}+z_{1-\beta}}{ES})^{2}
$$

Where $n\_{i}$ is the sample size required in each group ($i=1,2$), $\alpha$ is the specific level of significance and $z\_{1-\frac{\alpha}{2}}$ is the critical value corresponding to the significance level. $1-\beta $ is the selected power and $z\_{1-\beta}$ is the value from the standard normal distribution holding $1-\beta$ below it. ES is the effect size, defined as follows: 
$$
ES = \frac{|p_{1} = p_{2} |}{\sqrt{p(1-p)}}
$$ 

where $|p\_{1} =p\_{2} |$ is the absolute value of the difference in proportions between the two groups under the alternative hypothesis, $H\_{1}$, and $p$ is the proportion by pooling the observations from the two comparison groups.

In Stata, we can use the following code to calculate the sample size needed to reject the null hypothesis that $H\_{0} :p\_{1} = p\_{2}$ ($ H\_{1} :p\_{1} \neq p\_{2}$) given $\hat{p\_{1}} = 0.2, \hat{p\_{2}} = 0.6$ on different fixed power levels:

```stata
   power twoproportions 0.2 0.6, n(40(20)100) graph
```

![](https://github.com/hlmshtj-dan/pigo/blob/main/4.png?raw=true)


## Step by step

1. Specify a hypothesis test.

Usually, there are several hypotheses in a research design, but for sample size calculation, make explicit a null and alternative hypothesis.

2. Specify the significance level of the test.

Usually $\alpha = .05$ is used, but other values could be substituted instead.

3. Get the values of the parameters necessary to compute the power function.

To solve for sample size $n$, we need a value for the standard deviation and other parameters. Sometimes we need to use a pilot dataset to get these values.

4. Specify the intended power of the test.

The power of a test is the probability of finding significance if the alternative hypothesis is true.

5. Calculate the needed sample size for the fixed power level.
