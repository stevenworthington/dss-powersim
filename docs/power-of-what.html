<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Power of What? | dss-powersim</title>
  <meta name="description" content="This is a tutorial for power simulation" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Power of What? | dss-powersim" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a tutorial for power simulation" />
  <meta name="github-repo" content="IQSS/dss-powersim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Power of What? | dss-powersim" />
  
  <meta name="twitter:description" content="This is a tutorial for power simulation" />
  

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation.html"/>
<link rel="next" href="r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Power Simulation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Simulation-Based Power Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i>Table of Contents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="part"><span><b>I Concepts</b></span></li>
<li class="chapter" data-level="1" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>1</b> Power Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="power-analysis.html"><a href="power-analysis.html#canned-routines"><i class="fa fa-check"></i><b>1.1</b> Canned routines</a></li>
<li class="chapter" data-level="1.2" data-path="power-analysis.html"><a href="power-analysis.html#step-by-step"><i class="fa fa-check"></i><b>1.2</b> Step by step</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>2</b> Simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulation.html"><a href="simulation.html#customization"><i class="fa fa-check"></i><b>2.1</b> Customization</a></li>
<li class="chapter" data-level="2.2" data-path="simulation.html"><a href="simulation.html#step-by-step-1"><i class="fa fa-check"></i><b>2.2</b> Step by step</a></li>
</ul></li>
<li class="part"><span><b>II Preparation</b></span></li>
<li class="chapter" data-level="3" data-path="power-of-what.html"><a href="power-of-what.html"><i class="fa fa-check"></i><b>3</b> Power of What?</a>
<ul>
<li class="chapter" data-level="3.1" data-path="power-of-what.html"><a href="power-of-what.html#study-design"><i class="fa fa-check"></i><b>3.1</b> Study design</a></li>
<li class="chapter" data-level="3.2" data-path="power-of-what.html"><a href="power-of-what.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.2</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="power-of-what.html"><a href="power-of-what.html#step-1-model-specification"><i class="fa fa-check"></i><b>3.2.1</b> Step 1: model specification</a></li>
<li class="chapter" data-level="3.2.2" data-path="power-of-what.html"><a href="power-of-what.html#step-2-variable-composition"><i class="fa fa-check"></i><b>3.2.2</b> Step 2: Variable composition</a></li>
<li class="chapter" data-level="3.2.3" data-path="power-of-what.html"><a href="power-of-what.html#step-3-parameter-composition"><i class="fa fa-check"></i><b>3.2.3</b> Step 3: Parameter composition</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="power-of-what.html"><a href="power-of-what.html#mixed-effects-model"><i class="fa fa-check"></i><b>3.3</b> Mixed effects model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="power-of-what.html"><a href="power-of-what.html#step-1-model-specification-1"><i class="fa fa-check"></i><b>3.3.1</b> Step 1: model specification</a></li>
<li class="chapter" data-level="3.3.2" data-path="power-of-what.html"><a href="power-of-what.html#step-2-variable-composition-1"><i class="fa fa-check"></i><b>3.3.2</b> Step 2: Variable composition</a></li>
<li class="chapter" data-level="3.3.3" data-path="power-of-what.html"><a href="power-of-what.html#step-3-parameter-composition-1"><i class="fa fa-check"></i><b>3.3.3</b> Step 3: Parameter composition</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Implementation</b></span></li>
<li class="chapter" data-level="4" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>4</b> R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r.html"><a href="r.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>4.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="r.html"><a href="r.html#setup"><i class="fa fa-check"></i><b>4.1.1</b> Setup</a></li>
<li class="chapter" data-level="4.1.2" data-path="r.html"><a href="r.html#steps-4-5-simulate-and-automate"><i class="fa fa-check"></i><b>4.1.2</b> Steps 4-5: Simulate and automate</a></li>
<li class="chapter" data-level="4.1.3" data-path="r.html"><a href="r.html#step-6-summarize"><i class="fa fa-check"></i><b>4.1.3</b> Step 6: Summarize</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="r.html"><a href="r.html#mixed-effects-model-1"><i class="fa fa-check"></i><b>4.2</b> Mixed effects model</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r.html"><a href="r.html#step-4-5-simulate-automate"><i class="fa fa-check"></i><b>4.2.1</b> Step 4-5: Simulate &amp; automate</a></li>
<li class="chapter" data-level="4.2.2" data-path="r.html"><a href="r.html#step-6-summarize-1"><i class="fa fa-check"></i><b>4.2.2</b> Step 6: Summarize</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>5</b> Python</a>
<ul>
<li class="chapter" data-level="5.1" data-path="python.html"><a href="python.html#simple-linear-regression-2"><i class="fa fa-check"></i><b>5.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="python.html"><a href="python.html#setup-1"><i class="fa fa-check"></i><b>5.1.1</b> Setup</a></li>
<li class="chapter" data-level="5.1.2" data-path="python.html"><a href="python.html#step-4-simulate"><i class="fa fa-check"></i><b>5.1.2</b> Step 4: Simulate</a></li>
<li class="chapter" data-level="5.1.3" data-path="python.html"><a href="python.html#step-5-automate"><i class="fa fa-check"></i><b>5.1.3</b> Step 5: Automate</a></li>
<li class="chapter" data-level="5.1.4" data-path="python.html"><a href="python.html#step-6-summarize-2"><i class="fa fa-check"></i><b>5.1.4</b> Step 6: Summarize</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="python.html"><a href="python.html#mixed-effects-model-2"><i class="fa fa-check"></i><b>5.2</b> Mixed effects model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="python.html"><a href="python.html#step-4-simulate-1"><i class="fa fa-check"></i><b>5.2.1</b> Step 4: Simulate</a></li>
<li class="chapter" data-level="5.2.2" data-path="python.html"><a href="python.html#step-5-automate-1"><i class="fa fa-check"></i><b>5.2.2</b> Step 5: Automate</a></li>
<li class="chapter" data-level="5.2.3" data-path="python.html"><a href="python.html#step-6-summarize-3"><i class="fa fa-check"></i><b>5.2.3</b> Step 6: Summarize</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stata.html"><a href="stata.html"><i class="fa fa-check"></i><b>6</b> Stata</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stata.html"><a href="stata.html#simple-linear-regression-3"><i class="fa fa-check"></i><b>6.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="stata.html"><a href="stata.html#setup-2"><i class="fa fa-check"></i><b>6.1.1</b> Setup</a></li>
<li class="chapter" data-level="6.1.2" data-path="stata.html"><a href="stata.html#step-4-simulate-2"><i class="fa fa-check"></i><b>6.1.2</b> Step 4: Simulate</a></li>
<li class="chapter" data-level="6.1.3" data-path="stata.html"><a href="stata.html#step-5-automate-2"><i class="fa fa-check"></i><b>6.1.3</b> Step 5: Automate</a></li>
<li class="chapter" data-level="6.1.4" data-path="stata.html"><a href="stata.html#step-6-summarize-4"><i class="fa fa-check"></i><b>6.1.4</b> Step 6: Summarize</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="stata.html"><a href="stata.html#mixed-effects-model-3"><i class="fa fa-check"></i><b>6.2</b> Mixed effects model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="stata.html"><a href="stata.html#setup-3"><i class="fa fa-check"></i><b>6.2.1</b> Setup</a></li>
<li class="chapter" data-level="6.2.2" data-path="stata.html"><a href="stata.html#step-4-simulate-3"><i class="fa fa-check"></i><b>6.2.2</b> Step 4: Simulate</a></li>
<li class="chapter" data-level="6.2.3" data-path="stata.html"><a href="stata.html#step-5-automate-3"><i class="fa fa-check"></i><b>6.2.3</b> Step 5: Automate</a></li>
<li class="chapter" data-level="6.2.4" data-path="stata.html"><a href="stata.html#step-6-summarize-5"><i class="fa fa-check"></i><b>6.2.4</b> Step 6: Summarize</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="7" data-path="software-comparison.html"><a href="software-comparison.html"><i class="fa fa-check"></i><b>7</b> Software Comparison</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i>Resources</a>
<ul>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#stata-1"><i class="fa fa-check"></i>Stata</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-of-what" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Power of What?<a href="power-of-what.html#power-of-what" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The initial steps of power simulation involve nothing more than thinking and writing down your thoughts using a pencil and paper. But, prior to walking through these steps, there is an even more fundamental issue to be addressed - the power of what?</p>
<p>What quantity within your model do you wish to calculate power for? Overall model goodness-of-fit, individual parameters, or combinations of parameters? The point of entry for power analysis is always to identify the particular effect of interest, and for that you must answer the question: “power of what?”</p>
<div id="study-design" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Study design<a href="power-of-what.html#study-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The study design we will use as an example throughout this tutorial comes from Julian Quandt’s blogpost (<a href="https://julianquandt.com/post/power-analysis-by-data-simulation-in-r-part-iv/" class="uri">https://julianquandt.com/post/power-analysis-by-data-simulation-in-r-part-iv/</a>). He describes this as:</p>
<blockquote>
<p>A new hypothetical research question focused on music preference. The overarching research goal will be to find out whether Rock or Pop music is better. Of course, we could just ask people what they prefer, but we want a more objective measure of what is Rock and Pop (people might have different ideas about the genres). Therefore, we will have participants listen to a bunch of different songs that are either from a Spotify “best-of-pop” or “best-of-rock” playlist and have them rate each song on an evaluation scale from 0-100 points.</p>
</blockquote>
</div>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Simple linear regression<a href="power-of-what.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Canned routines exist to perform power analysis for some simple general linear models (GLMs), however, using simulation to calculate power for a GLM will serve as scaffolding to build intuition about the process of conducting power simulation more generally, which will be helpful when we later move to a more complex case using a mixed effects model. While the outcome in this example is bounded on the interval [0, 100], we will not concern ourselves with the issue of using a linear model with such an outcome. Likewise, we will make no effort to address the within-subject nature of the effect of interest in the GLM example.</p>
<div id="step-1-model-specification" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Step 1: model specification<a href="power-of-what.html#step-1-model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step in simulation-based power analysis is to write down the regression model of interest, including all variables and parameters:</p>
<p><span class="math display">\[
\textrm{liking}_i = \beta_0 + \beta_1 \times \textrm{genre}_i + \epsilon_i
\]</span></p>
<p>where the subscript <span class="math inline">\(i\)</span> denotes an individual song, <code>liking</code> is an integer-based rating of a given song on the interval [0, 100], <code>genre</code> is a dummy coded binary variable indicating whether the song is classified as “rock” or “pop”, and we assume <span class="math inline">\(\epsilon_{i} \sim \mathcal{N}(0, \sigma)\)</span>. The parameter of interest is <span class="math inline">\(\beta_1\)</span> - the average difference in the rating of songs between the two genres. Table 3.1 lists all of the variables and parameters in the model.</p>
<caption>
<span id="tab:param-def-glm">Table 3.1: </span>
</caption>
<div custom-style="Table Caption">
<em>Variables in the data-generating model and associated code-based names.</em>
</div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">code</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\textrm{liking}_i\)</span></td>
<td align="left"><span class="math inline">\(\texttt{liking_i}\)</span></td>
<td align="left">rating of song <span class="math inline">\(i\)</span> on the interval [0, 100]</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\textrm{genre}_i\)</span></td>
<td align="left"><span class="math inline">\(\texttt{genre_i}\)</span></td>
<td align="left">genre of song <span class="math inline">\(i\)</span> (0=‘pop’, 1=‘rock’)</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_0\)</span></td>
<td align="left"><span class="math inline">\(\texttt{beta_0}\)</span></td>
<td align="left">intercept; mean of liking rating for ‘pop’ genre</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_1\)</span></td>
<td align="left"><span class="math inline">\(\texttt{beta_1}\)</span></td>
<td align="left">‘slope’; mean difference btw ‘pop’ and ‘rock’ song ratings</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="left"><span class="math inline">\(\texttt{sigma}\)</span></td>
<td align="left">standard deviation of residuals</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(e_{i}\)</span></td>
<td align="left"><span class="math inline">\(\texttt{e_i}\)</span></td>
<td align="left">residual for song <span class="math inline">\(i\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="step-2-variable-composition" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Step 2: Variable composition<a href="power-of-what.html#step-2-variable-composition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we have the model equation, we need to specify the details of the explanatory variables. In our model, we only have a single binary predictor, so the only decision to make is which coding scheme to use: dummy coding or zero sum coding. Here, we chose dummy coding, since our primary interest is in the difference between the “rock” and “pop” genres.</p>
<p>In many other situations, we might include variables such as age and sex in the model. In which case we would need to determine reasonable settings for the range of age and the proportion of females to males. For example, the range of age might encompass the full possible range of human longevity (e.g., 0 to 120 years) or could be more focused on non-retired adults (e.g., 18 to 65 years). The proportion of females to males could theoretically vary anywhere in the interval (0, 1), but practically is rarely outside of the interval [0.45, 0.55].</p>
</div>
<div id="step-3-parameter-composition" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Step 3: Parameter composition<a href="power-of-what.html#step-3-parameter-composition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we need to establish the data-generating parameters in your model. You may draw on your own, or your colleague’s, substantive expertise about the phenomenom you’re studying to determine what paramater values are plausible. Or, you might look to the literature for studies that examined similar effects. Table 3.2 lists parameter values we will use as a starting point. Later, we will try alternative values and compare power for each.</p>
<caption>
<span id="tab:params-all-glm">Table 3.2: </span>
</caption>
<div custom-style="Table Caption">
<em>Settings for all data-generating parameters.</em>
</div>
<table>
<thead>
<tr class="header">
<th align="left">code</th>
<th align="left">value</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\texttt{beta_0}\)</span></td>
<td align="left">65</td>
<td align="left">intercept; i.e., mean of liking rating for ‘pop’ genre</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\texttt{beta_1}\)</span></td>
<td align="left">15</td>
<td align="left">slope; i.e, mean difference btw ‘pop’ and ‘rock’ song ratings</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\texttt{sigma}\)</span></td>
<td align="left">5</td>
<td align="left">residual (error) sd</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="mixed-effects-model" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Mixed effects model<a href="power-of-what.html#mixed-effects-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our mixed effects model example will follow the same steps as the simple linear regression, but this time incorporate some model machinery to account for by-subject clustering in the data.</p>
<div id="step-1-model-specification-1" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Step 1: model specification<a href="power-of-what.html#step-1-model-specification-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once again, we first write down the regression model of interest, including all variables and parameters:</p>
<p><span class="math display">\[
\textrm{liking}_{ij} = \beta_0 + U_{0j} + (\beta_1 + U_{1j}) \times \textrm{genre}_i + \epsilon_{ij}
\]</span></p>
<p>where the subscript <span class="math inline">\(i\)</span> denotes an individual song and <span class="math inline">\(j\)</span> a participant, <code>liking</code> is an integer-based rating of a given song on the interval [0, 100], <code>genre</code> is a dummy coded binary variable indicating whether the song is classified as “rock” or “pop”, and we assume <span class="math inline">\(U_{0j} \sim \mathcal{N}(0, \tau_0)\)</span>, <span class="math inline">\(U_{1j} \sim \mathcal{N}(0, \tau_1)\)</span>, <span class="math inline">\(\epsilon_{ij} \sim \mathcal{N}(0, \sigma)\)</span>. The parameter of interest is <span class="math inline">\(\beta_1\)</span> - the average (within-subject) difference in the rating of songs between the two genres. Table 3.3 lists all of the variables and parameters in the model.</p>
<caption>
<span id="tab:param-def-mixed">Table 3.3: </span>
</caption>
<div custom-style="Table Caption">
<em>Variables in the data-generating model and associated code-based names.</em>
</div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">code</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\textrm{liking}_{ij}\)</span></td>
<td align="left"><span class="math inline">\(\texttt{liking_ij}\)</span></td>
<td align="left">rating of song <span class="math inline">\(i\)</span> for participant <span class="math inline">\(j\)</span> on the interval [0, 100]</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\textrm{genre}_i\)</span></td>
<td align="left"><span class="math inline">\(\texttt{genre_i}\)</span></td>
<td align="left">genre of song <span class="math inline">\(i\)</span> (0=‘pop’, 1=‘rock’)</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_0\)</span></td>
<td align="left"><span class="math inline">\(\texttt{beta_0}\)</span></td>
<td align="left">intercept; mean of liking rating for ‘pop’ genre</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_1\)</span></td>
<td align="left"><span class="math inline">\(\texttt{beta_1}\)</span></td>
<td align="left">slope; mean difference btw ‘pop’ and ‘rock’ song ratings</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\tau_0\)</span></td>
<td align="left"><span class="math inline">\(\texttt{tau_0}\)</span></td>
<td align="left">standard deviation of by-subject random intercepts</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\tau_1\)</span></td>
<td align="left"><span class="math inline">\(\texttt{tau_1}\)</span></td>
<td align="left">standard deviation of by-subject random slopes</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\rho\)</span></td>
<td align="left"><span class="math inline">\(\texttt{rho}\)</span></td>
<td align="left">correlation between by-subject random intercepts and slopes</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="left"><span class="math inline">\(\texttt{sigma}\)</span></td>
<td align="left">standard deviation of residuals</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(U_{0j}\)</span></td>
<td align="left"><span class="math inline">\(\texttt{U_0j}\)</span></td>
<td align="left">random intercept for subject <span class="math inline">\(j\)</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(U_{1j}\)</span></td>
<td align="left"><span class="math inline">\(\texttt{U_1j}\)</span></td>
<td align="left">random slope for subject <span class="math inline">\(j\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(e_{ij}\)</span></td>
<td align="left"><span class="math inline">\(\texttt{e_ij}\)</span></td>
<td align="left">residual of song <span class="math inline">\(i\)</span> for participant <span class="math inline">\(j\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="step-2-variable-composition-1" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Step 2: Variable composition<a href="power-of-what.html#step-2-variable-composition-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We also need to think about the explanatory variables in our model. Since we only have a single binary predictor, we just need to decide which coding scheme to use: dummy coding or zero sum coding. Here, we chose dummy coding, since our primary interest is in the difference between the “rock” and “pop” genres.</p>
</div>
<div id="step-3-parameter-composition-1" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Step 3: Parameter composition<a href="power-of-what.html#step-3-parameter-composition-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we need to establish the data-generating parameters in your model. As before, you may determine what paramater values are plausible by drawing on substantive expertise about the phenomenom you’re studying or by referencing the literature for studies that report similar effects. Table 3.4 lists parameter values we will use as a starting point. Later, we will try alternative values and compare power for each.</p>
<caption>
<span id="tab:params-all-mixed">Table 3.4: </span>
</caption>
<div custom-style="Table Caption">
<em>Settings for all data-generating parameters.</em>
</div>
<table>
<thead>
<tr class="header">
<th align="left">code</th>
<th align="left">value</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\texttt{beta_0}\)</span></td>
<td align="left">65</td>
<td align="left">intercept; i.e., mean of liking rating for ‘pop’ genre</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\texttt{beta_1}\)</span></td>
<td align="left">15</td>
<td align="left">slope; i.e, mean difference btw ‘pop’ and ‘rock’ song ratings</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\texttt{tau_0}\)</span></td>
<td align="left">7</td>
<td align="left">by-subject random intercept sd</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\texttt{tau_1}\)</span></td>
<td align="left">3</td>
<td align="left">by-subject random slope sd</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\texttt{rho}\)</span></td>
<td align="left">0.2</td>
<td align="left">correlation between intercept and slope</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\texttt{sigma}\)</span></td>
<td align="left">5</td>
<td align="left">residual (error) sd</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="simulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/IQSS/dss-powersim/edit/master/03_preparation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["dss-powersim.pdf", "dss-powersim.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
